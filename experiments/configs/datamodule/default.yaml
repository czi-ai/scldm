# DataModule configuration
datamodule:
  _target_: scldm.datamodule.DataModule
  train_adata_path: ${dataset_paths.${dataset}.train}
  test_adata_path: ${dataset_paths.${dataset}.test}
  adata_attr: ${dataset_params.${dataset}.adata_attr}
  adata_key: ${dataset_params.${dataset}.adata_key}
  vocabulary_encoder: ${vocabulary_encoder}
  batch_size: 32
  test_batch_size: 32
  num_workers: 4
  seed: 42
  prefetch_factor: 2
  persistent_workers: true
  drop_last_indices: true
  drop_incomplete_batch: true
  sample_genes: ${dataset_params.${dataset}.sample_genes}
  genes_seq_len: ${dataset_params.${dataset}.genes_seq_len}
  val_as_test: false

vocabulary_encoder:
  _target_: scldm.encoder.VocabularyEncoderSimplified
  adata_path: ${dataset_paths.${dataset}.train}
  mask_token: "<MASK>"
  mask_token_idx: 0
  n_genes: ${dataset_params.${dataset}.n_genes}
  class_vocab_sizes: ${dataset_params.${dataset}.class_vocab_sizes}
  guidance_weight: ${dataset_params.${dataset}.guidance_weight}
  mu_size_factor: ${dataset_params.${dataset}.mu_size_factor}
  sd_size_factor: ${dataset_params.${dataset}.sd_size_factor}
  condition_strategy: ${dataset_params.${dataset}.condition_strategy}

# Dataset selection (override this in experiments)
dataset: dentate_gyrus

# Dataset-specific parameters
dataset_params:
  dentate_gyrus:
    n_genes: 17002
    class_vocab_sizes:
      clusters: 14
    guidance_weight:
      clusters: 1.0
    genes_seq_len: 6147
    sample_genes: expressed
    mu_size_factor: null
    sd_size_factor: null
    adata_attr: X
    adata_key: null
    condition_strategy: mutually_exclusive

  hlca:
    n_genes: 27997
    class_vocab_sizes:
      cell_type: 50
    guidance_weight:
      cell_type: 1.0
    genes_seq_len: 10186
    sample_genes: expressed
    mu_size_factor: null
    sd_size_factor: null
    adata_attr: layers
    adata_key: X_counts
    condition_strategy: mutually_exclusive

  tabula_muris:
    n_genes: 19734
    class_vocab_sizes:
      tissue: 16
    guidance_weight:
      tissue: 1.0
    genes_seq_len: 9059
    sample_genes: expressed
    mu_size_factor: null
    sd_size_factor: null
    adata_attr: layers
    adata_key: X_counts
    condition_strategy: mutually_exclusive

  czb_cd4_naive_holdout:
    n_genes: 2000
    class_vocab_sizes:
      cell_type: 18
      cytokine: 91
    guidance_weight:
      cell_type: 1.0
      cytokine: 1.0
    genes_seq_len: 2000
    sample_genes: all
    mu_size_factor: null
    sd_size_factor: null
    adata_attr: X
    adata_key: null
    condition_strategy: joint

  replogle:
    n_genes: 2000
    class_vocab_sizes:
      cell_line: 4
      gene: 2024
    guidance_weight:
      cell_line: 1.0
      gene: 1.0
    genes_seq_len: 2000
    sample_genes: all
    mu_size_factor: null
    sd_size_factor: null
    adata_attr: X
    adata_key: null
    condition_strategy: joint
